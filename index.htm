<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Checklist Diário - Coordenador Administrativo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #f8f9fa;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
      font-size: 14px;
    }
    th {
      background-color: #e9ecef;
    }
    .form-container {
      margin-bottom: 20px;
    }
    .form-container label {
      font-size: 14px;
      margin-right: 10px;
    }
    .form-container input, .form-container select {
      padding: 5px;
      margin-right: 15px;
      font-size: 14px;
    }
    .form-container button {
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 20px;
    }
    .form-container button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>

<h1>Checklist Diário - Coordenador Administrativo</h1>

<!-- Formulário de informações iniciais -->
<div class="form-container">
  <label for="nome">Nome:</label>
  <input type="text" id="nome" name="nome" placeholder="Digite seu nome" required>

  <label for="data">Data:</label>
  <input type="date" id="data" name="data" required>

  <label for="unidade">Unidade:</label>
  <select id="unidade" name="unidade" required>
    <option value="">Selecione</option>
    <option value="TCA">TCA</option>
    <option value="TCV">TCV</option>
    <option value="ABC">ABC</option>
    <option value="MCD">MCD</option>
    <option value="TBL">TBL</option>
    <option value="TPA">TPA</option>
    <option value="TBA">TBA</option>
    <option value="TSJ">TSJ</option>
    <option value="API">API</option>
    <option value="TPH">TPH</option>
    <option value="TCG">TCG</option>
  </select>
</div>

<form>
  <table>
    <thead>
      <tr>
        <th>Horário/Evento</th>
        <th>Atividade</th>
        <th>Ferramenta/Maquinário</th>
        <th>Plano de Reação</th>
        <th>Sim</th>
        <th>Não</th>
      </tr>
    </thead>
    <tbody id="tabelaAtividades">
      <!-- Atividades serão inseridas via JS -->
    </tbody>
  </table>

  <!-- Botão Enviar -->
  <div class="form-container">
    <button type="submit">Enviar</button>
  </div>
</form>

<!-- Scripts -->
<script>
  const atividades = [
    ["08:30 - 09:00", "Solicitar orçamento 2 dias antes da utilização", "E-mail", "Acionar Gerente administrativo"],
    ["08:30 - 09:00", "Lançamento de caixa 1 dia após o recebimento", "SICF", "Acionar Contas a Pagar (CAP)"],
    ["Conforme demanda", "Envio de DDA 1 dia de antecedência até as 17h00", "SICF", "Acionar Gerente Comercial"],
    ["Até 23:00 do último dia útil", "Validar os lançamentos das notas de serviço com e sem retenção", "SICF", "Acionar Contas a Pagar (CAP)"],
    ["Conforme demanda", "Realizar manutenções necessárias no CAR", "SICF / E-mail", "Acionar financeiro CTD"],
    ["Conforme demanda", "Corrigir falhas operacionais", "SICF", "Acionar financeiro CTD"],
    ["Conforme demanda", "Enviar DDA para financeiro", "SICF", "Acionar financeiro unidade"],
    ["Conforme demanda", "Conferir lançamento de despesas", "SICF", "-"],
    ["Conforme demanda", "Verificar a tributação quando houver devolução para a indústria", "SICF", "Acionar financeiro CTD"]
  ];

  const tbody = document.getElementById('tabelaAtividades');

  atividades.forEach((atv, i) => {
    const idx = i + 1;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${atv[0]}</td>
      <td>${atv[1]}</td>
      <td>${atv[2]}</td>
      <td>${atv[3]}</td>
      <td><input type="radio" name="atividade_${idx}" value="Sim" onclick="registrarHorario('hora_atividade_${idx}')"></td>
      <td><input type="radio" name="atividade_${idx}" value="Não" onclick="registrarHorario('hora_atividade_${idx}')"></td>
      <input type="hidden" name="hora_atividade_${idx}">
    `;
    tbody.appendChild(tr);
  });

  function registrarHorario(nomeCampo) {
    const agora = new Date().toLocaleString('pt-BR');
    const inputHidden = document.querySelector(`[name=${nomeCampo}]`);
    if (inputHidden && inputHidden.value === "") {
      inputHidden.value = agora;
    }
  }

  document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = new FormData(document.querySelector('form'));
    formData.append("nome", document.getElementById("nome").value);
    formData.append("data", document.getElementById("data").value);
    formData.append("unidade", document.getElementById("unidade").value);

    fetch('https://script.google.com/macros/s/AKfycbx48y6SZ0zeJPP0N9-Bd23udBO2QAqnUsId8g-UimKnS_iAt3smuGUjVTu5ylU4bre4yg/exec', {
      method: 'POST',
      body: formData
    })
    .then(response => response.text())
    .then(data => alert('Dados enviados com sucesso!'))
    .catch(error => alert('Erro ao enviar os dados: ' + error));
  });
</script>

</body>
</html>
